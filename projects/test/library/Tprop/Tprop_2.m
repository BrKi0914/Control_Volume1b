 function [K,rho,Cp,C,diagC] = Tprop_2(T,materialC,~)% Thermal properties at CV grid points.% Tprop version '2' (test).% 1 material with temperature-dependent thermal properties% (material has properties roughly like ice at -30 C)% Cpave is a weighted average defined by,%   Cpave = \int_{Tref}^T Cp(T') dT' / (T - Tref)% unpack material parameters typ = materialC{1};% initializations K    = zeros(size(typ)); Tref = 0;               % reference temperature (C)% Type 1 material% density rho = 917*ones(size(typ));% thermal conductivity K0    = 2;                 % conductivity at Tref dKdT  = -0.0140; K     = K0 + dKdT*(T - Tref);% specific heat Cp0   = 1880;              % specific heat at Tref dCpdT = 7; Cp    = Cp0 + dCpdT*(T - Tref);% bulk heat capacity C = rho .* Cp;% temperature weighted specific heat Cpave = Cp0 + dCpdT*(T - Tref)/2;% store Cpave in diagnostics cell array diagC = {Cpave};