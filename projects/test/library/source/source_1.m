 function [QS,Sfac,sourceP] = source_1(spaceP,t)% This function evaluates the source term during the setup stage.% It:%	> Finds the integral of the source term across each CV (QS)%	> Finds the ratio Sfac = QS/[S(z(i))*Dz(i)] where z(i) = grid pt for CV(i)%	> Returns values for source parameters in cell array sourceP.% For each CV,%	QS = \int S(z) dz = <S>*Dz	[W/m^2]% where <S> is the mean value of S across the CV.  The purpose of Sfac is% to allow us to estimate QS during the main time loop without having to do% an integration, eg.%	QS(i) = <S(i)> * Dz(i)%		  = [Sfac * S(z(i))] * Dz(i) .% This assumes the shape of S(z) doesn't change with time.% source version '1' (test).%   S(z,t) = 0 global N% Set source parameters S0      = 0; sourceP = {S0};% Set integral QS = zeros(N,1);% Set Sfac Sfac = ones(N,1);